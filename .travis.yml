os:
- linux
services:
- docker
language: node_js
node_js:
- 10.13.0
jdk:
- oraclejdk8
sudo: false
cache:
  directories:
  - node
  - node_modules
  - "$HOME/.m2"
env:
  global:
  - NODE_VERSION=10.13.0
  - SPRING_OUTPUT_ANSI_ENABLED=ALWAYS
  - SPRING_JPA_SHOW_SQL=false
  - secure: ZCe1lV7suC5h1vlLI36F/hITQGrnSSM8aJiTfthxbLDyqagv/1h+0zveLWvq82mhQSySonCztrkV1zvAexuvYSGqWGLdgGcvUxVI4dQL1reQrxhQKM3a8ZtU+F18CAcqRhvO0wtMqnYyILTwLZ7I72R6COpuKozJzjAvV1NsxHShwJCkYeBuRiyD9cSP5Jr054t2tYxp1CmAgSq7HQ1lQSMb/l+MAl5dBmaipSv0mEKsGF/C52+xhkbqmt4MrJ4805Atyy6rGXkwVSTFtnl4C9W+ZQQ8Rc/gWzF7vb3cV9w+K8MG/6DQQtczHpCXoPMrKG1YrsIDFe4QVOJF0Oz22uZhwuUbGk1vBJOPqiv/klnjPvc6CDSoTCssHNODVGqXqXtfJy2BH4d5VrNwsHdnaci4VY+F5xwBF4xfagJjjjWlvlT3Gy5SyvKIqau95zH0mwVYfgzj2NywZ5DJXAl2b/asCZxtgPaw0jIh5BVbgQvX4eGbV4yi+5ZnV8Y2b8F/PkA+1SFK3C1kcnTLnwWE9B63dULDrUeb1drFto8FhMsCEBDNqNTkUxd+9yGOz8Qpa38vhSfjf00znuRJnC50JuYi1iwVOc3W+WSA/ez1sCaeLNWtpPRXpKH6A95oz/Pouwlwc1X9pNwywtVimRcPURliWUNSiAAEDR7aXSU1a1w= #DOCKER_USER
  - secure: j9qOxivm2M6LOO0Z80Br03GoV/M6ZZI5n9WClqsmD9v+4bE2k7cSTejx8+uh55x5rH5+6Owjf8Vp9uU+JL1U52llgzyoKYnF6hJKsHFbYVEqVIEBroPIJZWMW8knAzZe0YCWu05H6BLAj/WzlNqv5YsvGivBqPG9leX3VAlhgsDDTKU2o7p6MfPJ7K/zeKsPDM/WFRsk5F4Di0ZuZAGh/WDLp+JS6v9Bi8g0hve1ideJA/R35XdWnceEq9m7l6acCNSOOsa7oTd1bSkZIP0V6nACA+PyQms4hu2+RY1Z1H9ubAwKV/vgSg7PNwnyU0tBua050sb18HTHt6mFmYwa/iazPJ+5G6+B4q66ZIvqfswdwMHZ5q5VV9baVeooDYGN6OSyVHRMywv4qUd9tUojSW1nKM+5h7TcQ1511TUjB4sg4sZSNQP+8m4cz/ye4aIJNHeDEieNiun+cSrKaVw7Nxmatx19n3eq34rwd30PvWuf8AL1/DwV1SEZznLv66ojxIf0LZg8Ik2F6Oj3GMEqEo5leO6RTJoECFU40THkrG2ehld9idTMSvzZw4dL7t4IHCoqxvl3URLpD3Ht1/NYeY1GVwzRaZ6WmbE5+inHZV5HDAnw1Ft79wOBJ5xhcsupRKTRQEaMYywtlmWm1/aoSDI4XmI+4h+zXmpdDvXfeYc= #DOCKER_PASS
  - COMMIT=${TRAVIS_COMMIT::7}
before_install:
- jdk_switcher use oraclejdk8
- java -version
- sudo /etc/init.d/mysql stop
- sudo /etc/init.d/postgresql stop
- nvm install $NODE_VERSION
- npm install -g npm
- node -v
- npm -v
install:
- npm install
script:
- chmod +x mvnw
- "./mvnw package -DskipTests=true -Pprod jib:dockerBuild"
notifications:
  webhooks:
    on_success: change
    on_failure: always
    on_start: false

after_success:
- docker login -u $DOCKER_USER" -p $DOCKER_PASS
- export TAG=latest
- export IMAGE_NAME=gustavocaraciolo/luulpos
- docker tag luulpos $IMAGE_NAME:$TAG
- docker push $IMAGE_NAME
